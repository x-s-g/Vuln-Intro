@@ -173,9 +173,9 @@ static int virtio_gpu_object_shmem_init(struct virtio_gpu_device *vgdev,struct virtio_gpu_object *bo,struct virtio_gpu_mem_entry **ents,unsigned int *nents)
 	 * since virtio_gpu doesn't support dma-buf import from other devices.
 	 */
 	shmem->pages = drm_gem_shmem_get_sg_table(&bo->base);
-	if (!shmem->pages)
-   {
+	if (IS_ERR(shmem->pages))
-   {
 		drm_gem_shmem_unpin(&bo->base);
-		return -EINVAL;
+		return PTR_ERR(shmem->pages);
 	}
 
 	if (use_dma_api) {

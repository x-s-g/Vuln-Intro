@@ -1541,6 +1541,7 @@ static int smb3_fs_context_parse_param(struct fs_context *fc,struct fs_parameter *param)
 
  cifs_parse_mount_err:
 	kfree_sensitive(ctx->password);
+	ctx->password = NULL;
 	return -EINVAL;
 }
 

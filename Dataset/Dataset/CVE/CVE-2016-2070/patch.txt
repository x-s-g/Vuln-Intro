@@ -2477,6 +2477,9 @@ static void tcp_cwnd_reduction(struct sock *sk, const int prior_unsacked,int fast_rexmit, int flag)
 	int newly_acked_sacked = prior_unsacked -(tp->packets_out - tp->sacked_out);
 
+	if (newly_acked_sacked <= 0 || WARN_ON_ONCE(!tp->prior_cwnd))
+		return;
+
 	tp->prr_delivered += newly_acked_sacked;
 	if (delta < 0)
 	{
 		int dividend = (int)tp->snd_ssthresh * tp->prr_delivered +tp->prior_cwnd - 1;
